---
description: "個人情報・機密情報のチェック（常時適用）"
alwaysApply: true
---

# Privacy & Security Check

## 個人情報の検出と防止

コード、設定ファイル、ドキュメントに以下の個人情報が含まれていないか、常にチェックしてください：

### 検出すべき個人情報

1. **メールアドレス**
   - パターン: `[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}`
   - 例: `user@example.com`, `name.surname@company.co.jp`
   - **例外**: ドメイン名のみ（`@example.com`）や、明示的に公開されている公式メールアドレスは可

2. **個人名（フルネーム）**
   - 実名の組み合わせ（姓 + 名）
   - 例: `田中太郎`, `John Smith`, `hiroshi.kuriyama`
   - **例外**: GitHubユーザー名や公開されているハンドル名は可

3. **電話番号**
   - パターン: `0\d{1,4}-\d{1,4}-\d{4}` (日本), `\+?\d{1,4}[\s-]?\d{1,4}[\s-]?\d{1,4}[\s-]?\d{1,4}` (国際)
   - 例: `090-1234-5678`, `+81-90-1234-5678`

4. **住所**
   - 郵便番号、都道府県、市区町村、番地など
   - 例: `〒123-4567 東京都...`

5. **APIキー・トークン・パスワード**
   - パターン: `sk-[a-zA-Z0-9]{32,}`, `ghp_[a-zA-Z0-9]{36}`, `xoxb-[0-9]+-[0-9]+-[a-zA-Z0-9-]+`
   - 実際の認証情報（`.env`ファイルや環境変数は除く）

6. **クレジットカード番号**
   - パターン: `\d{4}[\s-]?\d{4}[\s-]?\d{4}[\s-]?\d{4}`

7. **個人識別番号**
   - マイナンバー、パスポート番号、運転免許証番号など

### チェック方法

コードを編集・追加する際は、以下を確認：

1. **コミット前のチェック**
   - `grep -r "@.*\.[a-z]\{2,\}" .` でメールアドレスを検索
   - 個人名のパターンを検索
   - 機密情報のパターンを検索

2. **ファイルタイプ別の注意**
   - **ソースコード** (`.ts`, `.tsx`, `.js`): 個人情報は絶対に含めない
   - **設定ファイル** (`.json`, `.yaml`, `.toml`): 個人情報は環境変数や`.env`に分離
   - **ドキュメント** (`.md`, `.txt`): 個人情報は含めない（必要に応じてプレースホルダーを使用）
   - **自動生成ファイル** (`package-lock.json`, `node_modules/`): 通常は問題なし

3. **環境変数の使用**
   - 個人情報や機密情報は必ず環境変数（`.env`ファイル）に分離
   - `.env`ファイルは`.gitignore`に追加されていることを確認
   - `.env.example`や`.env.local.example`にはプレースホルダーのみ記載

### 発見時の対応

個人情報や機密情報を発見した場合：

1. **即座に削除または置換**
   - 実際の値をプレースホルダー（`YOUR_EMAIL@example.com`など）に置き換え
   - 必要に応じて環境変数に移行

2. **Git履歴の確認**
   - 既にコミットされている場合は、`git log`で履歴を確認
   - 必要に応じて`git filter-branch`やBFG Repo-Cleanerで履歴から削除

3. **機密情報の漏洩が疑われる場合**
   - APIキーやトークンは即座に無効化・再発行
   - 必要に応じて関係者に通知

### 例外事項

以下の場合は個人情報として扱わない：

- GitHubユーザー名（公開情報）
- 公開されている公式メールアドレス（例: `support@example.com`）
- ドメイン名のみ（`@example.com`）
- テスト用のダミーデータ（明示的にテスト用と記載されている場合）
- 自動生成ファイル（`package-lock.json`など）に含まれるnpmパッケージのURL

### 実装時の注意

- 新しいファイルを追加する際は、個人情報が含まれていないか確認
- コピー&ペーストする際は、元のファイルに個人情報が含まれていないか確認
- コミット前に必ず`git diff`で変更内容を確認
